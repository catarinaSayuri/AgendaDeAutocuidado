<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <title>Criar Conta</title>

    <!-- Fontes -->
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?display=swap&family=Noto+Sans:wght@400;500;700;900&family=Plus+Jakarta+Sans:wght@400;500;700;800"
    />

    <!-- Estilos internos -->
    <style>
      body {
        margin: 0;
        font-family: "Plus Jakarta Sans", "Noto Sans", sans-serif;
        background-color: #fcf8f8;
        color: #1b0e0e;
      }

      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 40px;
        border-bottom: 1px solid #f3e7e8;
      }

      header h2 {
        font-size: 1.2rem;
        font-weight: bold;
      }

      header a,
      nav a {
        text-decoration: none;
        color: #1b0e0e;
        font-size: 0.9rem;
        font-weight: 500;
        margin-right: 20px;
      }

      header button {
        background-color: #f3e7e8;
        border: none;
        border-radius: 9999px;
        padding: 10px 16px;
        font-weight: bold;
        color: #1b0e0e;
        cursor: pointer;
      }

      .container {
        max-width: 512px;
        margin: 40px auto;
        background-color: #fff;
        padding: 32px;
        border-radius: 12px;
      }

      h1 {
        text-align: center;
        font-size: 28px;
        font-weight: bold;
        margin-bottom: 24px;
      }

      label {
        display: block;
        margin-bottom: 8px;
        font-size: 1rem;
        font-weight: 500;
      }

      input {
        width: 100%;
        padding: 14px;
        margin-bottom: 20px;
        border: none;
        border-radius: 12px;
        background-color: #f3e7e8;
        color: #1b0e0e;
        font-size: 1rem;
      }

      input::placeholder {
        color: #994d4f;
      }

      button[type="submit"] {
        width: 100%;
        padding: 14px;
        background-color: #e9242a;
        color: #fcf8f8;
        border: none;
        border-radius: 9999px;
        font-size: 0.9rem;
        font-weight: bold;
        cursor: pointer;
      }

      p {
        text-align: center;
        margin-top: 16px;
        color: #994d4f;
        font-size: 0.9rem;
      }

      p a {
        text-decoration: underline;
        color: #994d4f;
      }

      nav {
        text-align: center;
        margin: 40px auto;
        background-color: #f3e7e8;
        padding: 12px 0;
        border-radius: 8px;
        max-width: 512px;
      }

      nav a {
        color: #1b0e0e;
        font-weight: 500;
        font-size: 1rem;
        padding: 8px 16px;
        text-decoration: none;
        transition: color 0.3s ease, background-color 0.3s ease;
      }

      nav a:hover {
        color: #fff;
        background-color: #e9242a;
        border-radius: 8px;
      }

      nav a:not(:last-child)::after {
        content: " | ";
        color: #ccc;
      }

      #response {
        display: none;
        text-align: center;
        margin-top: 16px;
        padding: 12px;
        border-radius: 8px;
        font-size: 0.9rem;
        font-weight: 500;
      }

      #response.success {
        background-color: #d4edda;
        color: #155724;
      }

      #response.error {
        background-color: #f8d7da;
        color: #721c24;
      }
    </style>
  </head>
  <body>
    <header>
      <div style="display: flex; align-items: center; gap: 10px">
        <svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M24 0.757355L47.2426 24L24 47.2426L0.757355 24L24 0.757355ZM21 35.7574V12.2426L9.24264 24L21 35.7574Z"
            fill="currentColor"
          ></path>
        </svg>
        <h2>Wellness Hub</h2>
      </div>
      <div style="display: flex; align-items: center; gap: 24px">
        <a href="/">Home</a>
        <a href="/agenda">Agenda</a>
        <a href="/atividades">Atividades</a>
        <button>Log In</button>
      </div>
    </header>

    <div class="container">
      <h1>Criar Conta</h1>
      <form id="registerForm">
        <label for="nome">Nome:</label>
        <input type="text" id="nome" name="nome" placeholder="Digite seu nome" required />

        <label for="email">Email:</label>
        <input type="email" id="email" name="email" placeholder="Digite seu email" required />

        <label for="senha">Senha:</label>
        <input type="password" id="senha" name="senha" placeholder="Digite sua senha" required />

        <button type="submit">Criar Conta</button>
        <div id="response"></div>
      </form>
      <p>Já tem uma conta? <a href="/login">Fazer Login</a></p>
    </div>

    <nav>
      <a href="/">Welcome</a>
      <a href="/myroutine">Minha Rotina</a>
      <a href="/agenda">Agenda</a>
      <a href="/atividades">Atividades</a>
      <a href="/calendario">Calendário</a>
      <a href="/login">Login</a>
    </nav>

    <script>
      document.getElementById('registerForm').addEventListener('submit', async function (event) {
        event.preventDefault();
        const responseDiv = document.getElementById('response');
        responseDiv.style.display = 'none';
        responseDiv.textContent = '';
        responseDiv.className = '';

        const formData = new FormData(this);
        const data = {
          nome: formData.get('nome'),
          email: formData.get('email'),
          senha: formData.get('senha')
        };

        try {
          const response = await fetch('/api/usuario/create', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data),
            credentials: 'include'
          });

          const result = await response.json();

          if (response.ok && result.success) {
            responseDiv.style.display = 'block';
            responseDiv.className = 'success';
            responseDiv.textContent = 'Conta criada com sucesso! Redirecionando...';
            setTimeout(() => {
              window.location.href = '/atividades';
            }, 1000);
          } else {
            responseDiv.style.display = 'block';
            responseDiv.className = 'error';
            responseDiv.textContent = result.message || 'Erro ao criar conta.';
          }
        } catch (error) {
          responseDiv.style.display = 'block';
          responseDiv.className = 'error';
          responseDiv.textContent = 'Erro ao conectar com o servidor. Tente novamente.';
        }
      });
    </script>
  </body>
</html>